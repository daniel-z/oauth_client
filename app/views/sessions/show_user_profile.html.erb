<!-- app/views/sessions/show_user_profile.html.erb -->
<% if @user_profile_data %>
  <div class="container">
    <h1 class="mt-5">User Profile</h1>

    <h2>Profile Information</h2>
    <ul class="list-group mb-4">
      <% @user_profile_data.each do |key, value| %>
        <% unless key == "providers" %>
          <li class="list-group-item"><strong><%= key.capitalize %>:</strong> <%= value %></li>
        <% end %>
      <% end %>
    </ul>

    <% if @user_profile_data["providers"].present? %>
      <h2>Providers</h2>
      <div style="width: 100%; overflow-x: auto;">
        <table class="table table-striped table-bordered" style="width: 100%; font-size: 0.8rem;">
          <thead>
            <tr>
              <th>ID</th>
              <th>UUID</th>
              <th>Provider ID</th>
              <th>Slug</th>
              <th>Name</th>
              <th>Website</th>
              <th>Headquarters</th>
              <th>Service Areas</th>
              <th>Laboratories</th>
              <th>Year Established</th>
              <th>Number of Employees</th>
              <th>Snippet Plain</th>
              <th>Snippet</th>
              <th>HTML Snippet</th>
              <th>Description</th>
              <th>HTML Description</th>
              <th>Average Rating</th>
              <th>Built-in Annotations</th>
              <th>Annotations</th>
              <th>Certifications</th>
              <th>Professional Associations</th>
              <th>Created At</th>
              <th>Updated At</th>
              <th>URLs</th>
            </tr>
          </thead>
          <tbody>
            <% @user_profile_data["providers"].each do |provider| %>
              <tr>
                <td><%= provider["id"] %></td>
                <td><%= provider["uuid"] %></td>
                <td><%= provider["provider_id"] %></td>
                <td><%= provider["slug"] %></td>
                <td><%= provider["name"] %></td>
                <td><%= link_to provider["website"], provider["website"], target: "_blank" %></td>
                <td><%= provider["headquarters"] %></td>
                <td><%= provider["service_areas"].join(", ") %></td>
                <td><%= provider["laboratories"].join(", ") %></td>
                <td><%= provider["year_established"] %></td>
                <td><%= provider["number_of_employees"] %></td>
                <td><%= provider["snippet_plain"] %></td>
                <td><%= provider["snippet"] %></td>
                <td><%= provider["html_snippet"].html_safe %></td>
                <td><%= provider["description"] %></td>
                <td><%= provider["html_description"].html_safe %></td>
                <td><%= provider["average_rating"] %></td>
                <td>
                  <ul>
                    <% provider["builtin_annotations"].each do |annotation| %>
                      <li><%= annotation["acronym"] %>: <%= annotation["name"] %> (<%= annotation["type"] %>)</li>
                    <% end %>
                  </ul>
                </td>
                <td><%= provider["annotations"].join(", ") %></td>
                <td><%= provider["certifications"].join(", ") %></td>
                <td><%= provider["professional_associations"].join(", ") %></td>
                <td><%= provider["created_at"] %></td>
                <td><%= provider["updated_at"] %></td>
                <td>
                  <ul>
                    <% provider["urls"].each do |key, url| %>
                      <li><%= key.capitalize %>: <%= link_to url, url, target: "_blank" %></li>
                    <% end %>
                  </ul>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% end %>
  </div>
<% else %>
  <p>No user profile data available.</p>
<% end %>
